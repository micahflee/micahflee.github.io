<!doctype html>
<head>
  <meta charset="utf-8">
  <title>Using Gajim Instead of Pidgin for More Secure OTR Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../static/style.css">
  <link rel="stylesheet" href="../static/fontawesome/css/all.min.css">
</head>
<body>
  <div class="wrapper">
    <article>
      
  
  <div class="blog-post">
    
    
      <h1 class="article-title">Using Gajim Instead of Pidgin for More Secure OTR Chat</h1>
    
    <p class="meta">
      Posted 
      
        in
        
          <a class="tag" href="../tags/crypto">crypto</a>
        
          <a class="tag" href="../tags/security">security</a>
        
      
    </p>
    
      <p>I’ve been using <a href="http://pidgin.im/">Pidgin</a> as my chat client for many years. The one feature of Pidgin that I care about more than any other is that it supports <a href="http://www.cypherpunks.ca/otr/">Off-the-Record</a> (OTR).</p>
<p>If you don’t know about OTR, it’s awesome. It lets you have end-to-end encrypted chat sessions with people so that only you and the person you’re chatting with can read the chat messages and all other parties—such as your chat server (often Google), your ISP, or anyone else eavesdropping on your—cannot. It also has cool features like forward secrecy that other cryptosystems like PGP don’t have. If you’ve ever been to a <a href="https://cryptoparty.org/wiki/CryptoParty">CryptoParty</a>, setting up Pidgin and OTR and learning how to verify keys is always on the schedule.</p>
<p>As awesome as it is, Pidgin and the Pidgin OTR plugin have problems. They rely on the libraries libpurple, libotr and libxml which are massive, written in C/C++, and are littered with memory corruption bugs. In 2011 EFF started the Open Source Security Auditing project and <a href="https://www.eff.org/deeplinks/2011/09/open-source-security-auditing">fixed several bugs</a> in Pidgin-related libraries, but that project was far from complete. Just look at Pidgin’s <a href="http://pidgin.im/news/security/">security advisory page</a> to see how often Pidgin security bugs get fixed. It’s great that bugs are actively getting fixed in software that experts recommend activists to use, but who knows how many more bugs haven’t been reported to the developers and are actively in use compromising the computers of people who put in extra work to remain secure.</p>
<p>I recently discovered <a href="https://gajim.org/">Gajim</a>, a jabber client written in python. Gajim also has an OTR plugin, but rather than depending on the bug-riddled libotr it uses <a href="https://github.com/afflux/pure-python-otr/">an implementation of OTR written completely in python</a> with no C bindings.</p>
<p>Writing programs in Python is a lot safer than writing them in C. With python, developers don’t get direct access to allocate, overwrite, and free memory. Instead they just declare variables and the python interpreter and it’s garbage collector take care of the messy memory management logic. This means that bugs in a python implementation of jabber and OTR are less likely to lead to arbitrary code execution.</p>
<p>If someone sends you a malicious message that triggers a bug in Gajim or it’s OTR plugin, they’re much more likely to just crash the program than to take over your computer.</p>
<p>That said, I noticed that <a href="https://en.wikipedia.org/wiki/Gajim#Security">Gajim’s Wikipedia page</a> says:</p>
<blockquote><p>Despite being written in Python (and thus generally invulnerable to buffer overflow attacks), Gajim has a history of a critical vulnerabilities. Up until late 2011, it was possible to forge a link such that when a receiving Gajim user clicks on it, arbitrary code would be executed on the Gajim user’s machine.</p>
</blockquote>
<p>As far as I know there hasn’t been a formal code review of Gajim. Just because there used to be an arbitrary code execution bug (that’s since been fixed) doesn’t mean that the project as a whole suffers from security problems.</p>
<p>I’ve only been using Gajim for two days now, but so far it seems great. After installing Gajim you need to click Edit, Plugins, and switch to the Available tab. From there you can download and install the Off-the-Record plugin. Back on the Installed tab you can click Configure to generate OTR keys for your accounts.</p>
<p>![Gajim plugins][gajim_otr.png]</p>
<p>I haven’t looked in detail at the plugin installation mechanism for Gajim, so I don’t know if the download goes over HTTPS, or if the package is signed. I hope that both are true, but it’s quite possible that neither is.</p>
<p>Of course, when Windows users download Pidgin’s OTR plugin from <a href="http://www.cypherpunks.ca/otr/">cypherpunks.ca</a>, it’s never been over HTTPS and has never forced signature verification either. We need to work in this.</p>
<p>I generated a new OTR key when I started using Gajim. But since I’ve already verified OTR keys with dozens of people, and my OTR finerprint is even printed on my business card, I wanted to keep my old OTR key.</p>
<p>So I decided to write a Pidgin to Gajim conversion script called <a href="https://github.com/micahflee/pidgin2gajim">pidgin2gajim</a>. If you too want to switch to Gajim but don’t want to give up your existing OTR key, hopefully this will be helpful.</p>
<p>I also posted a feature request on the <a href="https://github.com/afflux/pure-python-otr/">pure-python-otr</a> project to <a href="https://github.com/afflux/pure-python-otr/issues/30">add an “Import From Pidgin” button</a> to the Gajim OTR user interface, which will make this process much easier for users.</p>
<p><em>Update: After talking to some people it appears that libotr isn’t as bug-ridden as the other libraries that Pidgin depends on, libpurple and libxml2. I’m still glad there’s a native python implementation of OTR though.</em></p>


      
    
  </div>


    </article>
    <div class="sidebar">
      <p class="name"><a href="../">Micah Lee's blog</a></p>
      <p><img class="coffee" src="../static/images/micah-coffee.gif"></p>
      <ul class="sidebar-items">
        <li>
          <i class="fas fa-bolt"></i>
          Technologist at <a href="https://theintercept.com/staff/micah-lee/">The Intercept</a>
        </li>
        <li>
          <i class="fas fa-rocket"></i>
          Board of <a href="https://freedom.press/">Freedom of the Press</a>
        </li>
        <li>
          <i class="fas fa-at"></i>
          micah@micahflee.com
        </li>
        <li>
          <i class="fas fa-lock"></i>
          PGP 0x403C2657CD994F73
        </li>
        <li>
          <i class="fab fa-twitter"></i>
          <a href="https://twitter.com/micahflee">@micahflee</a>
        </li>
        <li>
          <i class="fab fa-mastodon"></i>
          <a href="https://mastodon.social/@micahflee">@micahflee@mastodon.social</a>
        </li>
        <li>
          <i class="fas fa-rss"></i>
          <a href="../feed.xml">Subscribe to feed</a>
        </li>
        <li>&nbsp;</li>
        <li>
          <i class="fab fa-github"></i>
          <a href="https://github.com/micahflee">GitHub</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/onionshare">OnionShare</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/torbrowser-launcher">Tor Browser Launcher</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/passphraseme">passphraseme</a>
        </li>
      </ul>

      <p><a href="https://standwithreality.org/"><img class="coffee" src="../static/images/reality.png"></a></p>
    </div>
  </div>
</body>
