<!doctype html>

<head>
  <meta charset="utf-8">
  <title>Two really simple things Microsoft can do to make Windows more secure against NSA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="twitter:card" content="summary" />
  
  <meta name="twitter:site" content="@micahflee" />
  <meta name="twitter:creator" content="@micahflee" />
  <meta property="og:url" content="https://micahflee.com/2013/12/two-really-simple-things-microsoft-can-do-to-make-windows-more-secure-against-nsa" />
  <meta property="og:title" content="Two really simple things Microsoft can do to make Windows more secure against NSA" />
  

  <link rel="stylesheet" href="../../../static/style.css">
  <link rel="stylesheet" href="../../../static/fontawesome/css/all.min.css">
</head>

<body>
  <div class="wrapper">
    <article>
      
  
  <div class="blog-post">
    
    
      <h1 class="article-title">Two really simple things Microsoft can do to make Windows more secure against NSA</h1>
    
    <p class="meta">
      Posted December 29, 2013
      
        in
        
          <a class="tag" href="../../../tags/crypto">crypto</a>
        
          <a class="tag" href="../../../tags/spies">spies</a>
        
          <a class="tag" href="../../../tags/security">security</a>
        
          <a class="tag" href="../../../tags/tor">tor</a>
        
      
    </p>
    
      <p>Thanks to Edward Snowden and journalists at Der Spiegel, today we learned about <a href="http://www.spiegel.de/international/world/the-nsa-uses-powerful-toolbox-in-effort-to-spy-on-global-networks-a-940969.html">Tailored Access Operations</a> (TAO), NSA’s world-class hacking team. There was a lot of interesting information in that article (like how they divert shipping of electronics to a secret warehouse where they can modify it to install backdoors!).</p>
<p>But I’m just going to talk about how they use Microsoft error reports to gather private information about Windows computers that can be used to compromise their security — a problem that’s trivially easy for Microsoft to fix.</p>
<p>You know how Windows programs crash all the time? In order to make that happen less, Microsoft collects information about the crash. They want to know what program crashed and what the current state of your computer is so that they can uncover the bug that you triggered and hopefully fix it in a future update. You can read more about exactly what data gets collected and how Microsoft “protects” this data by reading their <a href="http://windows.microsoft.com/en-US/Windows/microsoft-error-reporting-privacy-statement">Microsoft Error Reporting Service privacy policy</a>.</p>
<p><img src="windows_error.png" alt="Windows error reporting"></p>
<p>Because Microsoft doesn’t use freely available and widely used security and privacy technology, these error reports can be used against Windows users. From the <a href="http://www.spiegel.de/international/world/the-nsa-uses-powerful-toolbox-in-effort-to-spy-on-global-networks-a-940969-2.html">Spiegel article</a>:</p>
<blockquote><p>One example of the sheer creativity with which the TAO spies approach their work can be seen in a hacking method they use that exploits the error-proneness of Microsoft’s Windows. Every user of the operating system is familiar with the annoying window that occasionally pops up on screen when an internal problem is detected, an automatic message that prompts the user to report the bug to the manufacturer and to restart the program. These crash reports offer TAO specialists a welcome opportunity to spy on computers.</p>
<p>When TAO selects a computer somewhere in the world as a target and enters its unique identifiers (an IP address, for example) into the corresponding database, intelligence agents are then automatically notified any time the operating system of that computer crashes and its user receives the prompt to report the problem to Microsoft. An internal presentation suggests it is NSA’s powerful XKeyscore spying tool that is used to fish these crash reports out of the massive sea of Internet traffic.</p>
<p>The automated crash reports are a “neat way” to gain “passive access” to a machine, the presentation continues. Passive access means that, initially, only data the computer sends out into the Internet is captured and saved, but the computer itself is not yet manipulated. Still, even this passive access to error messages provides valuable insights into problems with a targeted person’s computer and, thus, information on security holes that might be exploitable for planting malware or spyware on the unwitting victim’s computer.</p>
<p>Although the method appears to have little importance in practical terms, the NSA’s agents still seem to enjoy it because it allows them to have a bit of a laugh at the expense of the Seattle-based software giant. In one internal graphic, they replaced the text of Microsoft’s original error message with one of their own reading, “This information may be intercepted by a foreign sigint system to gather detailed information and better exploit your machine.” (“Sigint” stands for “signals intelligence.”)</p>
</blockquote>
<p>So how could Microsoft easily prevent this from happening? They can do these two things:</p>
<p><strong>Use HTTPS!</strong></p>
<p>There’s no reason why any piece of software that needs to communicate back to its company’s servers shouldn’t use HTTPS instead of HTTP. It’s not hard to set up or maintain, it’s not expensive, it scales really well. It’s ridiculous that Mirosoft, the largest software company in the world, still uses HTTP for anything.</p>
<p>If they were using HTTPS, NSA would have to compromise the SSL key or do active man-in-the-middle attacks to get these error reports (and even man-in-the-middle attacks could be prevented with certificate pinning). However, just using HTTPS isn’t quite enough. Even if the error reports are encrypted, NSA can still force Microsoft to hand over their error report database.</p>
<p><strong>Use Tor!</strong></p>
<p>Windows, and every other operating system, should come with Tor installed. When software wants to send “anonymous error reports,” or “anonymous usage data to improve our service,” or anything else like that, they should actually make it anonymous by proxying those requests through the Tor network.</p>
<p>If Tor is installed, other software should use it to send anonymous data back home too. Firefox and Chrome should send error reports and usage data to Mozilla and Google over Tor instead of over the normal Internet. Ubuntu’s Unity should send “anonymous” Dash search results to productsearch.ubuntu.com over Tor, or else they can’t truly claim that they’re anonymous.</p>
<p>These technologies are freely available, widely used, and open source. It’s time that companies start acting like everything that happens on the Internet is being spied on.</p>


      <div id="commento"></div>
      <script src="https://cdn.commento.io/js/commento.js"></script>

      
        
        <div class="legacy-comments">
          <p class="legacy-comments-notice">Legacy comments, imported from previous version of this blog:</p>
          
            
              
  <div class="legacy-comment">
    <div class="legacy-comment-meta">
      <i class="fas fa-mask"></i>
      <div>
        <p class="legacy-comment-meta-author">anaal neuken</p>
        <p class="legacy-comment-meta-pub_date">April 19, 2014 07:14 AM</p>
      </div>
    </div>
    <div class="legacy-comment-body">
      <p>It's not my first time to pay a visit this website, i am browsing this website dailly and take nice facts from here 
daily.</p>

    </div>
  </div>
  

            
          
            
              
  <div class="legacy-comment">
    <div class="legacy-comment-meta">
      <i class="fas fa-mask"></i>
      <div>
        <p class="legacy-comment-meta-author">www.youtube.com</p>
        <p class="legacy-comment-meta-pub_date">August 6, 2014 01:10 AM</p>
      </div>
    </div>
    <div class="legacy-comment-body">
      <p>What's Taking place i'm new to this, I stumbled upon this I have found It positively helpful and it has helped 
me out loads. I am hoping to give a contribution &amp; assist different customers like its helped me.
Good job.</p>

    </div>
  </div>
  

            
          
        </div>
      
    
  </div>


    </article>
    <div class="sidebar">
      <p class="name centered"><a href="../../../">Micah Lee's blog</a></p>
      <p class="centered"><img class="fullwidth" src="../../../static/images/micah-coffee.gif"></p>
      <ul class="sidebar-items">
        <li>
          <i class="fas fa-bolt"></i>
          Director of Infosec at <a href="https://theintercept.com/staff/micah-lee/">The Intercept</a>
        </li>
        <li>
          <i class="fas fa-rocket"></i>
          Advisor at <a href="https://ddosecrets.com/">DDoSecrets</a>
        </li>
        <li>
          <i class="fas fa-rocket"></i>
          Cofounded <a href="https://freedom.press/">Freedom of the Press</a> (former)
        </li>
        <li>
          <i class="fas fa-at"></i>
          micah@micahflee.com
        </li>
        <li>
          <i class="fas fa-lock"></i>
          PGP <a href="/micah.asc">0x403C2657CD994F73</a>
        </li>
        <li>
          <i class="fab fa-keybase"></i>
          <a href="https://keybase.io/micahflee">@micahflee</a> on Keybase
        </li>
        <li>
          <i class="fab fa-twitter"></i>
          <a href="https://twitter.com/micahflee">@micahflee</a> on Twitter
        </li>
        <li>
          <i class="fab fa-mastodon"></i>
          <a href="https://mastodon.social/@micahflee">@micahflee@mastodon.social</a>
        </li>
        <li>
          <i class="fas fa-rss"></i>
          <a href="../../../feed.xml">Subscribe to feed</a>
        </li>
        <li>&nbsp;</li>
        <li>
          <i class="fab fa-github"></i>
          <a href="https://github.com/micahflee">GitHub</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/onionshare">OnionShare</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/torbrowser-launcher">Tor Browser Launcher</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/passphraseme">passphraseme</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://semiphemeral.com">Semiphemeral</a>
        </li>
      </ul>

      <p class="centered"><iframe class="centered" src="https://snowflake.torproject.org/embed.html" width="320"
          height="240" frameborder="0" scrolling="no"></iframe></p>

      <p class="centered"><a href="https://standwithreality.org/"><img class="fullwidth"
            src="../../../static/images/reality.png"></a>
      </p>

      <h3>Archives</h3>
      <p>Looking for an old post?
      <p>
      <p>Check the <a href="../../../archives/">archives</a>.</p>

      <h3>Tags</h3>
      
      
  <ul>
  
    <li><a href="../../../tags/advisory/">advisory</a></li>
  
    <li><a href="../../../tags/code/">code</a></li>
  
    <li><a href="../../../tags/crypto/">crypto</a></li>
  
    <li><a href="../../../tags/drama/">drama</a></li>
  
    <li><a href="../../../tags/hackers/">hackers</a></li>
  
    <li><a href="../../../tags/https/">https</a></li>
  
    <li><a href="../../../tags/journalism/">journalism</a></li>
  
    <li><a href="../../../tags/leaks/">leaks</a></li>
  
    <li><a href="../../../tags/linux/">linux</a></li>
  
    <li><a href="../../../tags/mobile/">mobile</a></li>
  
    <li><a href="../../../tags/onionshare/">onionshare</a></li>
  
    <li><a href="../../../tags/openpgp/">openpgp</a></li>
  
    <li><a href="../../../tags/qubes/">qubes</a></li>
  
    <li><a href="../../../tags/security/">security</a></li>
  
    <li><a href="../../../tags/semiphemeral/">semiphemeral</a></li>
  
    <li><a href="../../../tags/spies/">spies</a></li>
  
    <li><a href="../../../tags/subgraph/">subgraph</a></li>
  
    <li><a href="../../../tags/sysadmin/">sysadmin</a></li>
  
    <li><a href="../../../tags/tor/">tor</a></li>
  
    <li><a href="../../../tags/wikileaks/">wikileaks</a></li>
  
  </ul>


      <p class="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License"
            src="../../../static/images/cc-by-nc.png"></a>
        <br />
        <br />
        Blog posts are licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative
          Commons Attribution-NonCommercial</a>. You are free to share and adapt this content, but you must give me
        credit, you can't use it for commercial purposes, and if you make adaptations (like a translation), you must
        make it clear that it has been modified.
      </p>
    </div>
  </div>
</body>
