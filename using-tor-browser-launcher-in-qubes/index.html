<!doctype html>
<head>
  <meta charset="utf-8">
  <title>Using Tor Browser Launcher in Qubes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../static/style.css">
  <link rel="stylesheet" href="../static/fontawesome/css/all.min.css">
</head>
<body>
  <div class="wrapper">
    <article>
      
  
  <div class="blog-post">
    
    
      <h1 class="article-title">Using Tor Browser Launcher in Qubes</h1>
    
    <p class="meta">
      Posted 
      
        in
        
          <a class="tag" href="../tags/tor">tor</a>
        
          <a class="tag" href="../tags/qubes">qubes</a>
        
      
    </p>
    
      <p>I maintain a piece of software called <a href="https://github.com/micahflee/torbrowser-launcher">Tor Browser Launcher</a>. It takes care of downloading Tor Browser Bundle for you, verifying the gpg signature, making sure you’re always using the latest version of Tor Browser, and making it easier to launch.</p>
<p>I originally only made Tor Browser Launcher work in Debian-based distributions, but since the default templates in <a href="http://qubes-os.org/">Qubes</a> are based on Fedora, I recently ported it to RPM-based distributions as well. Here’s how to set it up.</p>
<p>You’ll need to build an RPM from the torbrowser-launcher source code first. Create a new appvm (I called mine tbl-builder), open a terminal in it, and follow these steps:</p>
<pre><code class="lang-bash">sudo yum -y install git python-psutil python-twisted pygame wmctrl gnupg fakeroot
git clone https://github.com/micahflee/torbrowser-launcher.git
cd torbrowser-launcher
./build_rpm.sh
</code></pre>
<p>When you’re done, it should have built an RPM package in dist/torbrowser-launcher-[version]-1.noarch.rpm. Go ahead and copy this to your templatevm:</p>
<pre><code class="lang-bash">qvm-copy-to-vm fedora-20-x64 dist/torbrowser-launcher-*.rpm
</code></pre>
<p>Now that you’ve copied the RPM to your templatevm, you can shut down and delete the appvm you just created. Next, open a terminal in your templatevm (e.g. fedora-20-x64), install torbrowser-launcher (and then cleanup your templatevm’s home dir):</p>
<pre><code class="lang-bash">sudo yum install QubesIncoming/tbl-builder/torbrowser-launcher-*-1.noarch.rpm
rm -r QubesIncoming
</code></pre>
<p>Now shut down your templatevm. Now all you have to do to add Tor Browser to your menu is go to an appvm’s settings, switch to the Applications tab, and move “Tor Browser” and “Tor Browser Settings” from Available to Selected, and save. If your appvm was already running when you installed torbrowser-launcher in your templatevm you’ll have to shut it down and restart it.</p>
<p>Now you can open Tor Browser the way you open any other software in any of your appvms.</p>
<p>Qubes also supports a special kind of netvm called a torvm. You can <a href="http://wiki.qubes-os.org/trac/wiki/UserDoc/TorVM">read about it here</a>. If you set an appvm’s netvm to be your torvm (making your appvm an anonvm), then all internet traffic in that appvm gets transparently proxied through Tor. This is great for a wide variety of things, but using the Tor Browser itself is still much wiser, because it does a lot of anti-forensics tricks that keep you anonymous. If you just use Firefox in an anonvm, your browser can much more easily be fingerprinted.</p>
<p>If you’d like to use Tor Browser in an anonvm, you have to do one more step to stop yourself from connecting to Tor through the Tor network. Open Tor Browser in your anonvm, click the onion icon and open Preferences. Under Proxy Settings, change “Use the recommended proxy settings for my version of Firefox” to “Transparent Torification (Requires custom transproxy or Tor router)”. Then go to <a href="https://check.torproject.org/">https://check.torproject.org/</a> to verify that you’re still connected to the Tor network.</p>
<p>That’s it. Now if your Tor Browser gets hacked and the attacker tries to leak your real IP address, it just won’t work. They’ll have to break out of Qubes isolation first.</p>


      
    
  </div>


    </article>
    <div class="sidebar">
      <p class="name"><a href="../">Micah Lee's blog</a></p>
      <p><img class="coffee" src="../static/images/micah-coffee.gif"></p>
      <ul class="sidebar-items">
        <li>
          <i class="fas fa-bolt"></i>
          Technologist at <a href="https://theintercept.com/staff/micah-lee/">The Intercept</a>
        </li>
        <li>
          <i class="fas fa-rocket"></i>
          Board of <a href="https://freedom.press/">Freedom of the Press</a>
        </li>
        <li>
          <i class="fas fa-at"></i>
          micah@micahflee.com
        </li>
        <li>
          <i class="fas fa-lock"></i>
          PGP 0x403C2657CD994F73
        </li>
        <li>
          <i class="fab fa-twitter"></i>
          <a href="https://twitter.com/micahflee">@micahflee</a>
        </li>
        <li>
          <i class="fab fa-mastodon"></i>
          <a href="https://mastodon.social/@micahflee">@micahflee@mastodon.social</a>
        </li>
        <li>
          <i class="fas fa-rss"></i>
          <a href="../feed.xml">Subscribe to feed</a>
        </li>
        <li>&nbsp;</li>
        <li>
          <i class="fab fa-github"></i>
          <a href="https://github.com/micahflee">GitHub</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/onionshare">OnionShare</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/torbrowser-launcher">Tor Browser Launcher</a>
        </li>
        <li>
          <i class="fas fa-code-branch"></i>
          <a href="https://github.com/micahflee/passphraseme">passphraseme</a>
        </li>
      </ul>

      <p><a href="https://standwithreality.org/"><img class="coffee" src="../static/images/reality.png"></a></p>
    </div>
  </div>
</body>
